generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id       String     @id @default(uuid())
  login    String     @unique
  name     String
  password String
  role     UserRole[] @default([STUDENT])
  courseId String?
  groupId  String?
  tickets  Ticket[]
  group    Group?     @relation(fields: [groupId], references: [id])
}

model Group {
  id         String @id @default(uuid())
  identifier String @unique
  courseId   String
  course     Course @relation(fields: [courseId], references: [id])
  users      User[]
}

model Course {
  id         String  @id @default(uuid())
  name       String
  identifier Int     @unique
  groups     Group[]
}

model Ticket {
  id          String       @id @default(uuid())
  name        String
  description String
  startDate   DateTime
  endDate     DateTime
  reason      TicketReason
  status      TicketStatus
  userId      String
  prooves     Prove[]
  user        User         @relation(fields: [userId], references: [id])
}

model Prove {
  id          String    @id @default(uuid())
  name        String
  path        String
  ticketId    String
  ticket      Ticket    @relation(fields: [ticketId], references: [id])
}


enum UserRole {
  ADMIN
  STUDENT
  PROFESSOR
}

enum TicketStatus {
  PENDING
  APPROVED
  REJECTED
}

enum TicketReason {
  SICKDAY
  FAMILY
  COMPETITION
}
